<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Minimal Mahjong Base</title>
<style>
/* 最小限の見た目 */
body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; padding:16px; }
.tile { display:inline-block; padding:6px 8px; margin:2px; border:1px solid #333; border-radius:4px; font-weight:600; }
.row { margin:8px 0; }
.section { margin:12px 0; }
button { margin-right:8px; }
.small { font-size:0.9em; color:#444; }
</style>
</head>
<body>
<h3>麻雀 ミニベース（装飾ほぼなし）</h3>

<div class="section">
  <button id="btnDeal">シャッフル＆配牌</button>
  <button id="btnDraw">ツモ</button>
  <button id="btnReset">リセット</button>
  <span class="small">山残り: <span id="wallCount">0</span></span>
</div>

<div id="table">
  <div class="row"><strong>東 (あなた)</strong> <span id="hand0"></span></div>
  <div class="row"><strong>南</strong> <span id="hand1"></span></div>
  <div class="row"><strong>西</strong> <span id="hand2"></span></div>
  <div class="row"><strong>北</strong> <span id="hand3"></span></div>
  <div class="row"><strong>山（先頭5枚）</strong> <span id="wallPreview"></span></div>
  <div class="row"><strong>捨て牌（東）</strong> <span id="discards0"></span></div>
</div>

<script>
// 牌表現: m=萬, p=筒, s=索, z=字牌 (1..7: 東南西北白發中)
function makeTiles(){
  const tiles = [];
  const suits = ['m','p','s'];
  suits.forEach(s => {
    for (let n=1;n<=9;n++){
      for (let i=0;i<4;i++) tiles.push(s + n);
    }
  });
  // 字牌 1..7
  for (let n=1;n<=7;n++){
    for (let i=0;i<4;i++) tiles.push('z' + n);
  }
  return tiles; // length 136
}

function shuffle(a){
  for (let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i], a[j]] = [a[j], a[i]];
  }
}

let wall = [], hands = [[],[],[],[]], discards = [[],[],[],[]];

function render(){
  for (let p=0;p<4;p++){
    document.getElementById('hand'+p).innerHTML = hands[p].map(t => `<span class="tile">${t}</span>`).join('');
    document.getElementById('discards'+p).innerHTML = (discards[p]||[]).map(t => `<span class="tile">${t}</span>`).join('');
  }
  document.getElementById('wallPreview').innerHTML = wall.slice(0,5).map(t=>`<span class="tile">${t}</span>`).join('');
  document.getElementById('wallCount').textContent = wall.length;
}

function deal(){
  wall = makeTiles();
  shuffle(wall);
  hands = [[],[],[],[]];
  discards = [[],[],[],[]];
  // 一般的な配り方（先に13枚ずつ、東だけ14にしてツモ順）
  for (let round=0; round<3; round++){
    for (let p=0;p<4;p++){
      for (let k=0;k<4;k++){
        hands[p].push(wall.shift());
      }
    }
  }
  // さらに 1枚ずつ +1×3回 で合計 12 -> add one more
  for (let p=0;p<4;p++) hands[p].push(wall.shift()); // now 13 each
  // 東家（player 0）は先手で14枚（ツモ済み）にする挙動は運用次第
  hands[0].push(wall.shift()); // give east one extra (14)
  render();
}

function drawTile(playerIndex=0){
  if (wall.length === 0) {
    alert('山がありません');
    return;
  }
  const t = wall.shift();
  hands[playerIndex].push(t);
  render();
}

document.getElementById('btnDeal').addEventListener('click', ()=> deal());
document.getElementById('btnDraw').addEventListener('click', ()=> drawTile(0)); // 自分がツモ
document.getElementById('btnReset').addEventListener('click', ()=>{
  wall = []; hands = [[],[],[],[]]; discards=[[],[],[],[]]; render();
});

// 初期表示
render();
</script>
</body>
</html>
